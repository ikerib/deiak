{% extends 'base.html.twig' %}

{% block head_stylesheets %}
    {{ parent() }}

    <link rel="stylesheet" href="{{ asset('bundles/app/fonts/glyphicons-halflings-regular.eot') }}">

    <style>
        .ui-autocomplete-loading {
            background: white url({{ asset('bundles/app/img/ui-anim_basic_16x16.gif') }}) right center no-repeat;
        }
    </style>
{% endblock %}

{% block body_class %} skin-blue {% endblock %}

{% block sidebar %}

    <section class="sidebar">
        <div class="user-panel">
            <div class="pull-left image">
                <img src="{{ asset('bundles/app/img/avatar04.png') }}" class="img-circle" alt="User Image">
            </div>
            <div class="pull-left info">
                <p>{{ ocs.NAME }}</p>
                <p>{{ ocs.IPADDR }}</p>
            </div>
        </div>

        <ul class="sidebar-menu">
            <li class="header">Informazioa</li>
            <li>{{ ocs.OSNAME}}</li>
            {% if ocs.OSCOMMENTS is defined %}
                <li>{{ ocs.OSCOMMENTS}}</li>
            {% endif %}
            {% if ocs.PROCESSORT is defined %}
                <li>CPU: {{ ocs.PROCESSORT }}</li>
            {% endif %}
            {% if ocs.MEMORY is defined %}
                <li>
                    <span class="label">Ram: {{ (ocs.MEMORY / 1024) | round }} Gb</span>
                    {% for s in storage %}
                        {% if s.TYPE == "Fixedxhard disk media" %}
                            <span class="label bg-green">HDD: {{ (s.DISKSIZE / 1024) |round }} Gb</span>
                            {% if 'KINGSTON' in s.NAME %}
                                <span class="label bg-red">SSD</span>
                            {% endif %}
                        {% elseif s.TYPE == "CD-ROM" %}
                            <span class="label bg-orange">CDROM</span>
                        {% endif %}
                    {% endfor %}
                </li>
            {% endif %}
        </ul>

        <ul class="sidebar-menu">
            <li class="header">Bestea</li>
            <li class="treeview">
                <a href="#"><i class="fa fa-chevron-circle-right"></i> klik</a>
                <ul class="treeview-menu">
                    <li>kaka</li>
                    <li>kako</li>
                </ul>
            </li>
        </ul>

    </section>

{% endblock %}

{% block main %}
    <div id="flash-messages"></div>
    <section class="content-header">
        <div class="row">
            <div class="col-sm-5">
                <h1 class="title">Inzidentzia berria</h1>
            </div>
        </div>
    </section>


    <section id="main" class="content">
        {{ form_start(form) }}
        <div class="row">
            {{ form_errors(form) }}
            <div class="col-sm-12 large">
                <div class="box box-primary">
                    <div class="box-header">
                        <i class="fa fa-edit"></i>
                        <h3 class="box-title">Sartu datuak eta gorde</h3>
                    </div>
                    <div class="box-body pad">
                        <div class="row">
                            <div class="col-sm-12 large">
                                &nbsp;
                                <br>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-xs-6">
                                <div class="form-group  field-text">
                                    {{ form_label(form.teknikoa, 'Teknikoa', { 'label_attr': {'class': 'control-label'} }) }}
                                    {{ form_errors(form.teknikoa) }}
                                    {{ form_widget(form.teknikoa, {'attr': {'class': 'form-control'}}) }}
                                </div>
                            </div>
                            <div class="col-xs-6">
                                <div class="form-group  field-text">
                                    {{ form_label(form.userid, 'Erabiltzailea', { 'label_attr': {'class': 'control-label'} }) }}
                                    {{ form_errors(form.userid) }}
                                    {{ form_widget(form.userid, {'attr': {'class': 'form-control'}}) }}
                                </div>
                            </div>

                            <div class="col-xs-6">
                                <div class="form-group">
                                    <select multiple name="kat_parent" id="aita" title="Kategoria" class="form-control">
                                        {% for k in kategorik %}
                                            <option value="{{ k.id }}">{{ k }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <select multiple name="kat_child" id="semea" title="Azpikategoria" class="form-control"></select>
                                </div>
                            </div>

                            <div class="col-xs-12">
                                <div class="form-group  field-text">
                                    {{ form_label(form.categories, 'Kategoriak', { 'label_attr': {'class': 'control-label'} }) }}
                                    {{ form_errors(form.categories) }}
                                    {{ form_widget(form.categories, {'attr': {'class': 'form-control'}}) }}
                                </div>
                            </div>

                            <div class="col-xs-12 form-actions" style="width: 100%;">
                                <div class="form-group">
                                    <div id="form-actions-row">
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fa fa-save"></i> Gorde
                                        </button>
                                        <a class="btn btn-secondary action-list" href="{{ path('deia_new') }}">Ezeztatu eta itzuli</a>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>
            </div>
        </div>
        {{ form_end(form) }}
    </section>

{% endblock %}
{% block body_javascript %}
    {{ parent() }}

    <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
    <script src="{{ path('fos_js_routing_js', { callback: 'fos.Router.setData' }) }}"></script>

    <script type="text/javascript">

        $(function() {

            $('#inzidentziacategory_categories').select2({
                theme: 'bootstrap',
                tags: true
            });

            $('#aita').on("click", function() {
                var url;
                var mival = $(this).val();
                url = Routing.generate('get_category', {'id': mival});

                $.getJSON(url, function(data) {
                    $("#semea").find('option').remove();
                    $.each(data, function() {
                        $("#semea").append('<option value="' + this.id + '">' + this.name + '</option>');
                    })
                })

            });

            $('#semea').on("click", function () {
                var sval = [];
                sval = $('#inzidentziacategory_categories').val();
                if (sval !== null) {
                    sval.push($(this).val());
                } else {
                    sval = $(this).val();
                }
                $('#inzidentziacategory_categories').val(sval).trigger("change");
            });

        });





    </script>

{% endblock %}